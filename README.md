# CShell

A powerful command-line interactive tool written in C.

---

## Project Background

This project is built upon **zPlatform** ‚Äî a proprietary embedded system development suite that provides Hardware Abstraction Layer (HAL), System Adaptation Layer (SAL), and various foundational libraries for application development.

With zPlatform, developers can write and run applications ‚Äî originally targeting embedded systems like VxWorks, Nucleus, or RTOS ‚Äî directly on Linux platforms, significantly simplifying embedded development and testing.

The standard zPlatform supports Windows + GCC compilation, but due to complex setup and limited practical value, those components have been removed from this repository.

> ‚úÖ **Our goal is to open-source `cshell` and keep the project structure as clean and understandable as possible.**

Except for the `cshell/` directory, all other components are auxiliary ‚Äî designed to help you understand how cshell works internally. That said, they remain valuable references, especially if you‚Äôre building a small embedded system. You‚Äôll find:

- Templated Makefiles
- Message-processing Finite State Machine (FSM)
- Observable FSM tracing mechanism
- Static AVL Tree / Static Hash Table
- Logging system
- Footprint utility
- Message Queue (Note: Platform-dependent; for demo purposes only)

---

## Key Features

- üöÄ Fast command parsing powered by lex/yacc
- üõ†Ô∏è Call functions or modify variables at runtime
- üíª Cross-platform support (Linux 32-bit / 64-bit)

---

## Build & Run

### 64-bit Linux

```bash
make -f x64.mk
./bin/target_b.linux.i64.exe
-> help
```

### 32-bit Linux

```bash
make -f x32.mk
./bin/target_a.linux.i32.exe
-> help
```

> üí° **Integration Tip**: To embed cshell into an existing CLI, consider triggering it via a special prefix character or switching CLI modes. Custom integration required.

---

## License (MIT)

This project is licensed under the **MIT License**.

The lexer and parser logic (defined in `.l` and `.y` files) represent the core intellectual contribution of this project. While licensed under MIT, the author encourages derivative works to open-source modifications to these components to benefit the community.

Files `cshell.lex.c`, `cshell.tab.c`, and `cshell.tab.h` under the `cshell/` directory are generated by `flex` and `bison`, and may contain strings like "GNU" or "GPL". However, according to the official FAQ:

> ‚ÄúThe code generated by Flex and Bison does not contain any GPL-licensed code, so you can use it in proprietary or permissively licensed projects.‚Äù  
> ‚Äî‚Äî GNU Bison/Flex FAQ

Thus, generated code is safe to use under MIT or in commercial projects.

> ‚ö†Ô∏è **Recommendation for Commercial Use**: To eliminate any potential license ambiguity, consider using lex/yacc alternatives with permissive licenses (e.g., re2c, Lemon).

---

## Important Warning

cshell is designed to help C developers:

- Quickly test functions inside running programs
- Dynamically modify variable values
- Automate unit tests or smoke tests via scripting

‚ö†Ô∏è **However, it is NOT a secure tool** ‚Äî it inherently breaks program encapsulation.

üìå **In production/release builds, you MUST disable cshell at compile time:**

```bash
make CSHELL_INCLUDE=0 -f x64.mk
```

No need to run `make clean` ‚Äî simply recompile to disable cshell functionality.
